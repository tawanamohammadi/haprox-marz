<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Professional tool for managing multiple domains on one port and configuring Warp for Marzban">
  <title>HAProxy & Marzban - Complete Installation Guide</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Fira+Code:wght@400;500&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/style.css">

  <style>
    .hero {
      padding: 6rem 0 3rem;
    }

    .hero h1 {
      font-size: 3rem;
      margin-bottom: 1rem;
    }

    .hero .subtitle {
      font-size: 1.5rem;
      color: var(--text-secondary);
      margin-bottom: 2rem;
    }

    .problem-solution {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin: 3rem 0;
    }

    .problem,
    .solution {
      padding: 2rem;
      border-radius: var(--radius-lg);
    }

    .problem {
      background: rgba(239, 68, 68, 0.1);
      border: 2px solid var(--danger);
    }

    .solution {
      background: rgba(16, 185, 129, 0.1);
      border: 2px solid var(--success);
    }

    .step {
      background: var(--bg-glass);
      padding: 2rem;
      border-radius: var(--radius-lg);
      margin-bottom: 2rem;
      border-left: 4px solid var(--primary);
    }

    .step h3 {
      color: var(--primary);
      margin-bottom: 1rem;
    }

    .warning-box {
      background: rgba(245, 158, 11, 0.1);
      border: 2px solid var(--warning);
      padding: 1.5rem;
      border-radius: var(--radius-md);
      margin: 2rem 0;
    }

    .success-box {
      background: rgba(16, 185, 129, 0.1);
      border: 2px solid var(--success);
      padding: 1.5rem;
      border-radius: var(--radius-md);
      margin: 2rem 0;
    }

    .faq-item {
      background: var(--bg-glass);
      padding: 1.5rem;
      border-radius: var(--radius-md);
      margin-bottom: 1rem;
      cursor: pointer;
      transition: all var(--transition-base);
    }

    .faq-item:hover {
      border-color: var(--primary);
    }

    .faq-answer {
      display: none;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--border-color);
    }

    .faq-item.active .faq-answer {
      display: block;
    }

    @media (max-width: 768px) {
      .problem-solution {
        grid-template-columns: 1fr;
      }

      .hero h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>

<body>
  <header class="header">
    <div class="container">
      <nav class="nav">
        <div class="logo">üöÄ HAProxy-Marz</div>
        <ul class="nav-links">
          <li><a href="#what">What is this?</a></li>
          <li><a href="#guide">Guide</a></li>
          <li><a href="#faq">FAQ</a></li>
          <li><a href="#troubleshooting">Troubleshooting</a></li>
          <li><a href="https://github.com/tawanamohammadi/haprox-marz">GitHub</a></li>
        </ul>
        <button class="lang-switch" onclick="window.location.href='../index.html'">ŸÅÿßÿ±ÿ≥€å</button>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero">
    <div class="container">
      <h1>Manage Multiple Domains on One Port</h1>
      <p class="subtitle">+ Unrestricted Access with Cloudflare Warp</p>
      <p style="max-width: 800px; margin: 0 auto 2rem;">
        This tool solves two main VPN server problems: <strong>multi-port management</strong> and <strong>service
          filtering</strong>
      </p>
      <div class="hero-buttons">
        <a href="#guide" class="btn btn-primary">Start Installation</a>
        <a href="#what" class="btn btn-secondary">Learn More</a>
      </div>
    </div>
  </section>

  <!-- What is this -->
  <section class="features" id="what">
    <div class="container">
      <h2 style="text-align: center; margin-bottom: 3rem;">üéØ What Does This Tool Do?</h2>

      <div class="problem-solution">
        <div class="problem">
          <h3>‚ùå Problem 1: Multiple Ports, Hard Management</h3>
          <ul style="margin-top: 1rem; line-height: 2;">
            <li>Marzban panel on port 8000</li>
            <li>VLESS on port 1001</li>
            <li>VMess on port 1002</li>
            <li>Trojan on port 1003</li>
            <li>Must open and manage all of them</li>
          </ul>
        </div>

        <div class="solution">
          <h3>‚úÖ Solution: HAProxy</h3>
          <ul style="margin-top: 1rem; line-height: 2;">
            <li>All services on port 443</li>
            <li>Domain-based routing</li>
            <li>Single point management</li>
            <li>Better security</li>
            <li>Only one port open</li>
          </ul>
        </div>
      </div>

      <div class="problem-solution">
        <div class="problem">
          <h3>‚ùå Problem 2: Filtering & Sanctions</h3>
          <ul style="margin-top: 1rem; line-height: 2;">
            <li>ChatGPT doesn't work</li>
            <li>Netflix is blocked</li>
            <li>Server IP gets blocked</li>
            <li>Limited access to sites</li>
          </ul>
        </div>

        <div class="solution">
          <h3>‚úÖ Solution: Cloudflare Warp</h3>
          <ul style="margin-top: 1rem; line-height: 2;">
            <li>Connect to Cloudflare network</li>
            <li>Clean and trusted IP</li>
            <li>Access to all services</li>
            <li>Auto-integration with Marzban</li>
          </ul>
        </div>
      </div>

      <div class="success-box" style="text-align: center;">
        <h3>üí° Important Note</h3>
        <p>You can install just one of these or both together. It depends on your needs!</p>
      </div>
    </div>
  </section>

  <!-- Installation Guide -->
  <section class="installation" id="guide">
    <div class="container">
      <h2 style="text-align: center; margin-bottom: 3rem;">üìö Step-by-Step Installation Guide</h2>

      <!-- Prerequisites -->
      <div class="glass-card" style="margin-bottom: 3rem;">
        <h3>üìã Prerequisites (Read Before Starting!)</h3>
        <p>Before installation, make sure you have:</p>
        <ul style="margin-top: 1rem; line-height: 2;">
          <li>‚úÖ Ubuntu 20.04+ or Debian 11/12 server</li>
          <li>‚úÖ Root or sudo access</li>
          <li>‚úÖ Port 443 is free (for HAProxy)</li>
          <li>‚úÖ Domains connected to your server IP</li>
        </ul>

        <div class="warning-box" style="margin-top: 2rem;">
          <strong>‚ö†Ô∏è Important:</strong> If you don't have a domain, first buy one and create subdomains (panel, vless,
          vmess, ...) and point A records to your server IP.
        </div>
      </div>

      <!-- Quick Install -->
      <div class="step">
        <h3>Step 1: Download and Run</h3>
        <p>Run these commands in your server terminal:</p>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">bash</span>
            <button class="copy-btn" onclick="copyCode(this, 'install-1')">Copy</button>
          </div>
          <pre><code id="install-1">git clone https://github.com/tawanamohammadi/haprox-marz.git
cd haprox-marz
chmod +x install.sh
sudo ./install.sh</code></pre>
        </div>
      </div>

      <!-- HAProxy Installation -->
      <div class="step">
        <h3>Step 2: Install HAProxy (Multi-Domain Management)</h3>
        <p><strong>If you only need Warp, skip this section.</strong></p>

        <h4 style="margin-top: 2rem;">2.1 Select Option</h4>
        <p>In the menu, enter <code>1</code>:</p>
        <pre style="background: var(--bg-secondary); padding: 1rem; border-radius: var(--radius-sm);">
1) üõ°Ô∏è  Install HAProxy Router (SNI)  ‚Üê Choose this
2) üå©Ô∏è  Install Cloudflare Warp (Marzban)
3) üöÄ  Install BOTH (Full Setup)
...
Enter your choice: 1
</pre>

        <h4 style="margin-top: 2rem;">2.2 Enter Domains</h4>
        <p>Enter your domains. Example:</p>
        <div class="code-block">
          <div class="code-header">
            <span class="code-lang">Example</span>
          </div>
          <pre><code>üì• Panel domain: panel.yourdomain.com
üì• VLESS+WS domain: vless.yourdomain.com
üì• VMESS+TCP domain: vmess.yourdomain.com
üì• XHTTP domain: trojan.yourdomain.com
üì• Hysteria domain: hysteria.yourdomain.com
üì• Reality domain: reality.yourdomain.com</code></pre>
        </div>

        <h4 style="margin-top: 2rem;">2.3 Internal Ports</h4>
        <p>If you don't want to change them, just press Enter to use defaults:</p>
        <pre style="background: var(--bg-secondary); padding: 1rem; border-radius: var(--radius-sm);">
üìç Local port for panel [8000]: ‚Üê Press Enter
üìç Port for VLESS+WS [1001]: ‚Üê Press Enter
üìç Port for VMESS+TCP [1002]: ‚Üê Press Enter
...
</pre>

        <div class="success-box" style="margin-top: 2rem;">
          <strong>‚úÖ Done!</strong> HAProxy is installed. Now you need to configure your services (Xray, panel) to use
          internal ports.
        </div>
      </div>

      <!-- Warp Installation -->
      <div class="step">
        <h3>Step 3: Install Warp (Unrestricted Access)</h3>
        <p><strong>If you only need HAProxy, skip this section.</strong></p>

        <h4 style="margin-top: 2rem;">3.1 Select Option</h4>
        <p>In the menu, enter <code>2</code></p>

        <h4 style="margin-top: 2rem;">3.2 Choose Method</h4>
        <p>Select option <code>1</code> (Xray core method):</p>
        <pre style="background: var(--bg-secondary); padding: 1rem; border-radius: var(--radius-sm);">
Choose setup method:
1) Xray core method (recommended)  ‚Üê This one
2) Wireguard kernel method

Enter your choice: 1
</pre>

        <h4 style="margin-top: 2rem;">3.3 Warp+ Key (Optional)</h4>
        <p>If you don't have a Warp+ key, enter <code>n</code>:</p>
        <pre style="background: var(--bg-secondary); padding: 1rem; border-radius: var(--radius-sm);">
Do you have a Warp+ license key? (y/n): n
</pre>

        <h4 style="margin-top: 2rem;">3.4 Traffic Selection</h4>
        <p>Enter <code>n</code> so only specific sites use Warp:</p>
        <pre style="background: var(--bg-secondary); padding: 1rem; border-radius: var(--radius-sm);">
Route ALL traffic through Warp? (y/n): n
</pre>

        <h4 style="margin-top: 2rem;">3.5 Auto Integration</h4>
        <p>Enter <code>y</code> to automatically add to Marzban:</p>
        <pre style="background: var(--bg-secondary); padding: 1rem; border-radius: var(--radius-sm);">
Do you want to automatically integrate Warp into Marzban config? (y/n): y

Enter Marzban core config path [/var/lib/marzban/core.json]: ‚Üê Press Enter
</pre>

        <div class="success-box" style="margin-top: 2rem;">
          <strong>‚úÖ Done!</strong> Warp is installed and added to Marzban. Just restart Marzban:
          <div class="code-block" style="margin-top: 1rem;">
            <div class="code-header">
              <span class="code-lang">bash</span>
              <button class="copy-btn" onclick="copyCode(this, 'restart-1')">Copy</button>
            </div>
            <pre><code id="restart-1">marzban restart</code></pre>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section class="features" id="faq">
    <div class="container">
      <h2 style="text-align: center; margin-bottom: 3rem;">‚ùì Frequently Asked Questions</h2>

      <div class="faq-item" onclick="this.classList.toggle('active')">
        <h3>1. Do I need to install both parts?</h3>
        <div class="faq-answer">
          <p><strong>No.</strong> Depending on your needs:</p>
          <ul>
            <li>Only have multi-port problem? ‚Üí Install only HAProxy</li>
            <li>Only have filtering problem? ‚Üí Install only Warp</li>
            <li>Have both problems? ‚Üí Install both (option 3)</li>
          </ul>
        </div>
      </div>

      <div class="faq-item" onclick="this.classList.toggle('active')">
        <h3>2. Where do I get domains?</h3>
        <div class="faq-answer">
          <p>You need to:</p>
          <ol>
            <li>Buy a domain (e.g., from Namecheap, Cloudflare, or any other service)</li>
            <li>Create subdomains: panel, vless, vmess, trojan, hysteria, reality</li>
            <li>Point A records for each subdomain to your server IP</li>
          </ol>
        </div>
      </div>

      <div class="faq-item" onclick="this.classList.toggle('active')">
        <h3>3. Do I need SSL/TLS?</h3>
        <div class="faq-answer">
          <p><strong>Yes.</strong> HAProxy only routes traffic. SSL certificates must be installed on backend services.
          </p>
          <p>Easy solution with Certbot:</p>
          <div class="code-block">
            <pre><code>sudo apt install certbot
sudo certbot certonly --standalone -d panel.yourdomain.com</code></pre>
          </div>
        </div>
      </div>

      <div class="faq-item" onclick="this.classList.toggle('active')">
        <h3>4. What if I make a mistake?</h3>
        <div class="faq-answer">
          <p>Don't worry! The script backs up before any changes:</p>
          <div class="code-block">
            <pre><code>sudo ./install.sh --rollback</code></pre>
          </div>
        </div>
      </div>

      <div class="faq-item" onclick="this.classList.toggle('active')">
        <h3>5. How do I know if Warp is working?</h3>
        <div class="faq-answer">
          <p>Use the diagnostics tool:</p>
          <div class="code-block">
            <pre><code>sudo ./install.sh --diagnostics</code></pre>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Troubleshooting -->
  <section class="installation" id="troubleshooting">
    <div class="container">
      <h2 style="text-align: center; margin-bottom: 3rem;">üÜò Common Issues</h2>

      <div class="glass-card" style="margin-bottom: 2rem;">
        <h3>Issue: Port 443 is in use</h3>
        <p><strong>Symptom:</strong> <code>[ERROR] Port 443 is already in use</code></p>
        <p><strong>Solution:</strong></p>
        <div class="code-block">
          <pre><code># See what's using the port
sudo ss -tulnp | grep :443

# Usually Nginx or Apache
sudo systemctl stop nginx
sudo systemctl stop apache2</code></pre>
        </div>
      </div>

      <div class="glass-card" style="margin-bottom: 2rem;">
        <h3>Issue: HAProxy won't start</h3>
        <p><strong>Solution:</strong></p>
        <div class="code-block">
          <pre><code># Check logs
sudo journalctl -u haproxy -n 50

# Validate config
sudo haproxy -c -f /etc/haproxy/haproxy.cfg</code></pre>
        </div>
      </div>

      <div class="glass-card" style="margin-bottom: 2rem;">
        <h3>Issue: Warp not working</h3>
        <p><strong>Solution:</strong></p>
        <div class="code-block">
          <pre><code># Full diagnostics
sudo ./install.sh --diagnostics

# Check Marzban logs
docker logs marzban -f

# Restart
marzban restart</code></pre>
        </div>
      </div>

      <div class="success-box">
        <h3>üí° Golden Tip</h3>
        <p>If you don't know what's wrong, run this first:</p>
        <div class="code-block">
          <pre><code>sudo ./install.sh --diagnostics</code></pre>
        </div>
        <p>This tool checks everything and shows you the problem.</p>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="footer-links">
        <a href="https://github.com/tawanamohammadi/haprox-marz">GitHub</a>
        <a href="https://github.com/tawanamohammadi/haprox-marz/issues">Report Issue</a>
        <a href="https://github.com/tawanamohammadi/haprox-marz/blob/main/LICENSE">License</a>
        <a href="../index.html">ŸÅÿßÿ±ÿ≥€å</a>
      </div>
      <p style="color: var(--text-muted);">
        Made with ‚ù§Ô∏è by <a href="https://github.com/tawanamohammadi">Tawana Mohammadi</a>
      </p>
      <p style="color: var(--text-muted); font-size: 0.875rem;">
        If this tool helped you, please give the project a ‚≠ê!
      </p>
    </div>
  </footer>

  <script src="../assets/js/main.js"></script>
</body>

</html>